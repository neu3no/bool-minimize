/*
 * Author
 *  Christian Neubauer
 *  web: http://neu3no.de/  twitter: @neu3no  mail: the@neu3no.de
 *    
 * Licence
 *  (cc-by-nc) 2012 
 *  This work is licensed under the Creative Commons Attribution-NonCommercial 
 *  3.0 Unported License. To view a copy of this license, visit 
 *  http://creativecommons.org/licenses/by-nc/3.0/.
 * 
 * Project
 *  website: http://neu3no.de/bool-minimize
 *  github : https://github.com/neu3no/bool-minimize
 * 
 */
if(!Object.N3OFUNCZ){alert("functions.js needs to be embedded first!")}function quine(c){this.tables=new Array();this.picharts=new Array();this.literalCount=0;this.termcount=0;this.matrix=c;this.empty=true;this.firstTable()}quine.prototype.getTable=function(c){if(!c){c=0}if(c>=this.tables.length||c<0){return false}return this.tables[c]};quine.prototype.firstTable=function(){var d=this.matrix.slice(0);var f=new Array();var c=d.max();for(i=0;i<c.literalCount();i++){f[i]=new Array()}for(i in d){var e=d[i];if(e>>1<<1!=e){f[(e>>1).oneLiteralCount()].push(new Array(e>>1,0,false));this.empty=false}}this.tables.push(f);this.literalCount=c.literalCount();return f};quine.prototype.compareTerms=function(d,c){var h=d[1],g=c[1];var f,e,j;if(h==g){f=d[0]&~(h);e=c[0]&~(h);j=f^e;if(j.oneLiteralCount()==1){return new Array(d[0],h|j,0)}}return false};quine.prototype.compare=function(){var h=this.tables[this.tables.length-1].slice(0);var e=new Array();var g=new Array();for(i=0;i<this.literalCount;i++){e[i]=new Array()}var f=0;for(var c=0;c<h.length-1;c++){for(teAidx in h[c]){for(teBidx in h[c+1]){var d=this.compareTerms(h[c][teAidx],h[c+1][teBidx]);var j=(d[0]<<this.literalCount)+d[1];if(d){h[c][teAidx][2]=true;h[c+1][teBidx][2]=true;if(g.indexOf(j)==-1){e[c].push(d);f=g.push(j)}}}}}this.termcount=f;for(c in h){for(tidx in h[c]){if(h[c][tidx][2]==false){e[c].push(h[c][tidx].slice(0));this.termcount++}}}if(!f==0){this.tables.push(e)}return(f>0)};quine.prototype.pILine=function(g,d){var f=[];var j=d.twoPowPartition();for(i=0;i<Math.pow(2,j.length);i++){var e=0+i;var h=0;var c=0;while(e>0){if(e%2>0){c+=j[h]}h++;e>>=1}f.push(g|c)}return f};quine.prototype.pIChart=function(){var e={mint:new Array(),rows:{},cols:{}};var h=this.tables[this.tables.length-1].slice(0);for(tidx in h){var d=h[tidx].slice(0);while(d.length>0){var g=d.shift();var f=g[0];var c=g[1];var j=this.pILine(f,c);e.mint=e.mint.concat(j).unique();e.rows[new Array(f,c)]=j;for(m in j){if(e.cols[j[m]]==undefined){e.cols[j[m]]=new Array()}e.cols[j[m]].push(new Array(f,c))}}}this.picharts.push(e);return e};quine.prototype.pIChartRowDominance=function(){var d={mint:new Array(),rows:{},cols:{}};var g=this.picharts[this.picharts.length-1];var e=0;d.mint=g.mint.slice(0);for(i in g.rows){d.rows[i]=g.rows[i].slice(0)}for(i in g.cols){d.cols[i]=g.cols[i].slice(0)}for(ri in d.rows){if(d.rows[ri].length==0){delete d.rows[ri];e++}for(rib in d.rows){if(rib!=ri&&d.rows[ri]!=undefined&&d.rows[rib]!=undefined){if(d.rows[ri].containsEachArray(d.rows[rib])){delete d.rows[rib];e++;for(coli in d.cols){var f=d.cols[coli].slice(0);d.cols[coli]=new Array();for(ai in f){var c=f[ai];if(rib!=c){d.cols[coli].push(c)}}}}}}}if(e>0){this.picharts.push(d);return true}return false};quine.prototype.pIChartColumnDominance=function(){var j={mint:new Array(),rows:{},cols:{}};var c=this.picharts[this.picharts.length-1];var h={};var f=this.termcount;var n=0;var d=new Array();var g=0;j.mint=c.mint.slice(0);for(i in c.rows){j.rows[i]=c.rows[i].slice(0)}for(i in c.cols){j.cols[i]=c.cols[i].slice(0)}for(coli in j.cols){var p=j.cols[coli].length;if(h[p]==undefined){h[p]=new Array()}h[p].push(coli)}for(i in h){if(Number(i)<f){f=Number(i)}if(Number(i)>n){n=Number(i)}}for(lidx=f;lidx<this.termcount;lidx++){if(h[lidx]==undefined){continue}for(a=0;a<h[lidx].length;a++){var k=h[lidx][a];for(b=a+1;b<h[lidx].length;b++){var e=h[lidx][b];if(j.cols[e]!=undefined&&j.cols[k]!=undefined&&j.cols[e].containsEachArray(j.cols[k])&&j.cols[k].containsEachArray(j.cols[e])){delete j.cols[e];g=d.push(Number(e))}}}for(hidx=lidx+1;hidx<this.termcount+1;hidx++){if(h[lidx]==undefined||h[hidx]==undefined){continue}for(leii in h[lidx]){var o=h[lidx][leii];for(heii in h[hidx]){var q=h[hidx][heii];if(j.cols[q]!=undefined&&j.cols[q].containsEachArray(j.cols[o])){delete j.cols[q];g=d.push(Number(q))}}}}}for(ri in j.rows){var l=j.rows[ri].slice(0);j.rows[ri]=new Array();for(vi in l){if(d.indexOf(l[vi])==-1){j.rows[ri].push(Number(l[vi]))}}}if(g>0){this.picharts.push(j);return true}return false};quine.prototype.getPIChart=function(c){if(!c){c=0}if(c>=this.picharts.length||c<0){return false}return this.picharts[c]};quine.prototype.solve=function(f){var c=10;var e=0;var d;do{d=this.compare();e++}while(e<c&&d);this.pIChart();e=0;do{d=this.pIChartColumnDominance();d=d||this.pIChartRowDominance();e++}while(e<c&&d);f(d)};